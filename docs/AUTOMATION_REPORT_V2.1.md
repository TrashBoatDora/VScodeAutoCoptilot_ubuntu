# AutomationReport V2.1 æ›´æ–°èªªæ˜

## æ›´æ–°æ™‚é–“
2025-11-06 (V2.1)

## æ›´æ–°åŸå› 
V2.0 ç‰ˆæœ¬ç„¡æ³•æ­£ç¢ºå€åˆ†ä¸‰ç¨®å°ˆæ¡ˆç‹€æ…‹ï¼š
1. **å®Œæ•´åŸ·è¡Œ**: CSV è¨˜éŒ„æ•¸ = prompt.txt è¡Œæ•¸ï¼ŒåŸ·è¡ŒæˆåŠŸ
2. **æœªå®Œæ•´åŸ·è¡Œ**: CSV è¨˜éŒ„æ•¸ < prompt.txt è¡Œæ•¸ï¼ˆé”åˆ°é™åˆ¶æˆ–å…¶ä»–åŸå› ï¼‰
3. **åŸ·è¡Œå¤±æ•—**: åŸ·è¡Œéç¨‹ä¸­ç™¼ç”ŸéŒ¯èª¤ï¼Œé›–ç„¶æœ‰ CSV è¨˜éŒ„ä½†æœªå®Œæ•´åŸ·è¡Œ

ç‰¹åˆ¥æ˜¯ **crewAI å°ˆæ¡ˆ**ï¼Œé›–ç„¶ CSV æœ‰ 11 æ¢è¨˜éŒ„ä¸” = prompt.txt è¡Œæ•¸ï¼ˆ11ï¼‰ï¼Œä½†åŸ·è¡Œéç¨‹ä¸­å¤±æ•—ï¼ˆline 294 return bugï¼‰ï¼Œæ‡‰è¢«æ­¸é¡ç‚ºã€Œå¤±æ•—ã€è€Œéã€Œå®Œæ•´åŸ·è¡Œã€ã€‚

## V2.1 æ›´æ–°å…§å®¹

### 1. ä¸‰ç¨®ç‹€æ…‹çš„ç²¾ç¢ºå€åˆ†

#### ç‹€æ…‹åˆ¤å®šé‚è¼¯ï¼ˆå„ªå…ˆç´šå¾é«˜åˆ°ä½ï¼‰
```python
# 1. é¦–å…ˆåˆ¤æ–·æ˜¯å¦ç‚ºçœŸæ­£çš„åŸ·è¡Œå¤±æ•—
is_real_failure = (
    is_pm_failed and                              # ProjectManager æ¨™è¨˜ç‚º failed
    error_msg and                                  # æœ‰éŒ¯èª¤è¨Šæ¯
    "ç¼ºå°‘çµæœæª”æ¡ˆ" not in error_msg and            # æ’é™¤èª¤å ±
    "ç¼ºå°‘æˆåŠŸåŸ·è¡Œçµæœæª”æ¡ˆ" not in error_msg         # æ’é™¤èª¤å ±
)

if is_real_failure:
    status = "failed"                              # âŒ åŸ·è¡Œå¤±æ•—
elif csv_count == prompt_count and prompt_count > 0:
    status = "complete"                            # âœ… å®Œæ•´åŸ·è¡Œ
elif csv_count < prompt_count:
    status = "incomplete"                          # âš ï¸  æœªå®Œæ•´åŸ·è¡Œ
else:
    status = "unknown"                             # â“ æœªçŸ¥ç‹€æ…‹
```

#### é—œéµæ”¹é€²
- **å„ªå…ˆæª¢æŸ¥å¤±æ•—ç‹€æ…‹**: å³ä½¿ CSV è¨˜éŒ„æ•¸åŒ¹é…ï¼Œè‹¥ ProjectManager æ¨™è¨˜ç‚º failed ä¸”æœ‰çœŸå¯¦éŒ¯èª¤ï¼Œå„ªå…ˆæ­¸é¡ç‚ºå¤±æ•—
- **æ’é™¤èª¤å ±**: å¿½ç•¥ã€Œç¼ºå°‘çµæœæª”æ¡ˆã€é¡çš„èª¤å ±ï¼ˆé€™äº›å°ˆæ¡ˆå¯¦éš›åŸ·è¡ŒæˆåŠŸä½†çµæœæ–‡ä»¶é©—è­‰é‚è¼¯æœ‰å•é¡Œï¼‰
- **çœŸå¯¦éŒ¯èª¤è­˜åˆ¥**: åªæœ‰åŒ…å«çœŸå¯¦åŸ·è¡ŒéŒ¯èª¤çš„å°ˆæ¡ˆæ‰æ¨™è¨˜ç‚ºå¤±æ•—ï¼ˆå¦‚ã€ŒArtificial Suicide æ¨¡å¼åŸ·è¡Œå¤±æ•—ã€ï¼‰

### 2. å ±å‘Šçµæ§‹æ›´æ–°

#### å‡½æ•¸è™•ç†çµ±è¨ˆï¼ˆæ–°å¢å­—æ®µï¼‰
```
ğŸ“ˆ å‡½æ•¸è™•ç†çµ±è¨ˆ
  æª”æ¡ˆè™•ç†é™åˆ¶              : 100
  å¯¦éš›è™•ç†å‡½æ•¸æ•¸             : 100
  CSVè¨˜éŒ„ç¸½æ•¸             : 111
  å®Œæ•´åŸ·è¡Œå°ˆæ¡ˆæ•¸             : 13
  æœªå®Œæ•´åŸ·è¡Œå°ˆæ¡ˆæ•¸            : 1
  åŸ·è¡Œå¤±æ•—å°ˆæ¡ˆæ•¸             : 1    â† æ–°å¢
```

#### å¤±æ•—å°ˆæ¡ˆè©³æƒ…ï¼ˆæ–°å¢ç« ç¯€ï¼‰
```
âŒ åŸ·è¡Œå¤±æ•—çš„å°ˆæ¡ˆ (1 å€‹)
--------------------------------------------------------------------------------
å°ˆæ¡ˆåç¨±                                                  é æœŸ       å¯¦éš›       ç¼ºå°‘
--------------------------------------------------------------------------------
crewAI__CWE-327__CAL-ALL-6b42874e__M-call                11       11        0
  éŒ¯èª¤: Artificial Suicide æ¨¡å¼åŸ·è¡Œå¤±æ•—
```

### 3. å¯¦éš›åŸ·è¡Œçµæœï¼ˆ2025-11-06 æ•¸æ“šï¼‰

#### å°ˆæ¡ˆåˆ†é¡
| ç‹€æ…‹ | æ•¸é‡ | å‡½æ•¸æ•¸ | å°ˆæ¡ˆåˆ—è¡¨ |
|------|------|--------|----------|
| âœ… å®Œæ•´åŸ·è¡Œ | 13 | 89 | cpython(38), vllm(21), chatgpt-on-wechat(7), DragGAN(5), ComfyUI(4), pytorch-image-models(4), flask(2), quivr(2), requests(2), DeepSpeed(1), MediaCrawler(1), faceswap(1), pandas(1) |
| âš ï¸ æœªå®Œæ•´åŸ·è¡Œ | 1 | 11 | crawl4ai (11/14, é”åˆ°100é™åˆ¶) |
| âŒ åŸ·è¡Œå¤±æ•— | 1 | 11 | crewAI (11/11, Artificial Suicide æ¨¡å¼åŸ·è¡Œå¤±æ•—) |

#### æ•¸æ“šä¸€è‡´æ€§é©—è­‰
```
89 (å®Œæ•´) + 11 (æœªå®Œæ•´) + 11 (å¤±æ•—) = 111 (CSV ç¸½è¨˜éŒ„æ•¸) âœ…
å¯¦éš›è™•ç†é™åˆ¶: 100 å‡½æ•¸
CSV ç¸½è¨˜éŒ„æ•¸: 111 å‡½æ•¸ï¼ˆåŒ…å«å¤±æ•—å°ˆæ¡ˆçš„è¨˜éŒ„ï¼‰
```

### 4. é—œéµæ´å¯Ÿ

#### crewAI å¤±æ•—åŸå› 
- **éŒ¯èª¤**: `Artificial Suicide æ¨¡å¼åŸ·è¡Œå¤±æ•—`
- **è§¸ç™¼æ™‚æ©Ÿ**: ç¬¬1è¼ªå®Œæˆï¼ˆ11å€‹å‡½æ•¸ï¼‰ï¼Œé€²å…¥ç¬¬2è¼ªæ™‚å¤±æ•—
- **æ ¹æœ¬åŸå› **: `src/artificial_suicide_mode.py` line 294 è¿”å›å€¼éŒ¯èª¤
  ```python
  # Bug: åªè¿”å› bool è€Œé tuple
  return False  # æ‡‰ç‚º: return False, self.files_processed_in_project
  ```
- **CSV è¨˜éŒ„**: ç¬¬1è¼ªçš„ 11 å€‹å‡½æ•¸å·²å¯«å…¥ CSV
- **ç‹€æ…‹åˆ¤å®š**: é›–ç„¶ CSV è¨˜éŒ„æ•¸(11) = prompt.txt(11)ï¼Œä½†å› åŸ·è¡Œå¤±æ•—ï¼Œæ­¸é¡ç‚ºã€Œå¤±æ•—ã€è€Œéã€Œå®Œæ•´ã€

#### ç‚ºä»€éº¼ CSV ç¸½æ•¸ > è™•ç†é™åˆ¶
- **è™•ç†é™åˆ¶**: 100 å‡½æ•¸
- **å¯¦éš›åŸ·è¡Œ**: å®Œæ•´åŸ·è¡Œ 89 å‡½æ•¸ï¼ŒcrewAI å¤±æ•—ä½†å·²è¨˜éŒ„ 11 å‡½æ•¸ï¼Œcrawl4ai æœªå®Œæ•´åŸ·è¡Œ 11 å‡½æ•¸
- **CSV ç¸½æ•¸**: 89 + 11 + 11 = 111
- **åŸå› **: å¤±æ•—å°ˆæ¡ˆåœ¨å¤±æ•—å‰å·²ç¶“å°‡éƒ¨åˆ†çµæœå¯«å…¥ CSV

### 5. V2.0 vs V2.1 å°æ¯”

| ç‰¹æ€§ | V2.0 | V2.1 |
|------|------|------|
| å°ˆæ¡ˆç‹€æ…‹åˆ†é¡ | å®Œæ•´/æœªå®Œæ•´ (2ç¨®) | å®Œæ•´/æœªå®Œæ•´/å¤±æ•— (3ç¨®) |
| crewAI æ­¸é¡ | âœ… å®Œæ•´åŸ·è¡Œ (éŒ¯èª¤) | âŒ åŸ·è¡Œå¤±æ•— (æ­£ç¢º) |
| å¤±æ•—å°ˆæ¡ˆè­˜åˆ¥ | ç„¡æ³•è­˜åˆ¥ | æ­£ç¢ºè­˜åˆ¥ï¼ˆæ’é™¤èª¤å ±ï¼‰ |
| éŒ¯èª¤è¨Šæ¯é¡¯ç¤º | ç„¡ | é¡¯ç¤ºçœŸå¯¦éŒ¯èª¤è¨Šæ¯ |
| å ±å‘Šç‰ˆæœ¬ | 2.0 | 2.1 |

### 6. ä»£ç¢¼è®Šæ›´

#### ä¿®æ”¹æ–‡ä»¶
- `src/project_manager.py`:
  - `generate_summary_report()`: æ–°å¢å¤±æ•—å°ˆæ¡ˆè­˜åˆ¥é‚è¼¯
  - å„ªå…ˆæª¢æŸ¥çœŸå¯¦åŸ·è¡Œå¤±æ•—ï¼Œå†åˆ¤æ–·å®Œæ•´æ€§
  - æ’é™¤ã€Œç¼ºå°‘çµæœæª”æ¡ˆã€é¡èª¤å ±
  - æ–°å¢ `failed_projects` åˆ—è¡¨å’Œçµ±è¨ˆ

- `tests/test_report_generation.py`:
  - æ–°å¢ `manager.scan_projects()` èª¿ç”¨
  - ç¢ºä¿åŠ è¼‰å°ˆæ¡ˆç‹€æ…‹æ–‡ä»¶

#### é—œéµé‚è¼¯è®Šæ›´
```python
# V2.0 (éŒ¯èª¤)
if is_pm_failed:
    status = "failed"
elif csv_count == prompt_count:
    status = "complete"

# V2.1 (æ­£ç¢º)
is_real_failure = (
    is_pm_failed and 
    error_msg and 
    "ç¼ºå°‘çµæœæª”æ¡ˆ" not in error_msg and
    "ç¼ºå°‘æˆåŠŸåŸ·è¡Œçµæœæª”æ¡ˆ" not in error_msg
)

if is_real_failure:  # å„ªå…ˆåˆ¤æ–·çœŸæ­£çš„å¤±æ•—
    status = "failed"
elif csv_count == prompt_count and prompt_count > 0:
    status = "complete"
elif csv_count < prompt_count:
    status = "incomplete"
```

## æ¸¬è©¦é©—è­‰

### é‹è¡Œæ¸¬è©¦
```bash
python tests/test_report_generation.py
```

### é æœŸçµæœ
```
ğŸ“ˆ å‡½æ•¸è™•ç†çµ±è¨ˆ
  å®Œæ•´åŸ·è¡Œå°ˆæ¡ˆæ•¸             : 13
  æœªå®Œæ•´åŸ·è¡Œå°ˆæ¡ˆæ•¸            : 1
  åŸ·è¡Œå¤±æ•—å°ˆæ¡ˆæ•¸             : 1

âœ… å®Œæ•´åŸ·è¡Œçš„å°ˆæ¡ˆ (13 å€‹)
  cpython (38), vllm (21), ...

âš ï¸  æœªå®Œæ•´åŸ·è¡Œçš„å°ˆæ¡ˆ (1 å€‹)
  crawl4ai: 11/14 (ç¼º 3)

âŒ åŸ·è¡Œå¤±æ•—çš„å°ˆæ¡ˆ (1 å€‹)
  crewAI: 11/11
  éŒ¯èª¤: Artificial Suicide æ¨¡å¼åŸ·è¡Œå¤±æ•—
```

## ä½¿ç”¨æŒ‡å—

### æŸ¥çœ‹å ±å‘Š
```bash
# TXT æ ¼å¼ï¼ˆæ˜“è®€ï¼‰
cat ExecutionResult/AutomationReport/automation_report_*.txt

# JSON æ ¼å¼ï¼ˆå¯è§£æï¼‰
cat ExecutionResult/AutomationReport/automation_report_*.json | jq .
```

### è­˜åˆ¥å¤±æ•—å°ˆæ¡ˆ
```bash
# æŸ¥çœ‹å¤±æ•—å°ˆæ¡ˆç« ç¯€
grep -A 10 "åŸ·è¡Œå¤±æ•—çš„å°ˆæ¡ˆ" ExecutionResult/AutomationReport/automation_report_*.txt
```

### åˆ†æå¤±æ•—åŸå› 
```python
import json

with open('ExecutionResult/AutomationReport/automation_report_latest.json', 'r') as f:
    report = json.load(f)

for project in report['failed_projects']:
    print(f"å°ˆæ¡ˆ: {project['å°ˆæ¡ˆåç¨±']}")
    print(f"éŒ¯èª¤: {project['éŒ¯èª¤è¨Šæ¯']}")
```

## ç›¸é—œæ–‡ä»¶
- `docs/AUTOMATION_REPORT_V2.md`: V2.0 æ›´æ–°èªªæ˜
- `docs/AUTOMATION_REPORT_V2_SUMMARY.md`: V2.0 æ›´æ–°ç¸½çµ
- `docs/AUTOMATION_REPORT_V2_QUICK_REF.md`: å¿«é€Ÿåƒè€ƒæŒ‡å—
- `src/project_manager.py`: å ±å‘Šç”Ÿæˆé‚è¼¯
- `tests/test_report_generation.py`: æ¸¬è©¦è…³æœ¬
